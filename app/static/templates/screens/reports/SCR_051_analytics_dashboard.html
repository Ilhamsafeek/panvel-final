{% extends "base.html" %}

{% block title %}Reports & Analytics{% endblock %}

{% block head %}
<style>
    /* Reports Specific Styles */
    .reports-container {
        padding: 24px;
        background: var(--background-light);
        min-height: calc(100vh - var(--header-height));
    }

    /* Enhanced Tab Navigation */
    .reports-tab-nav {
        background: white;
        border-radius: 12px;
        padding: 8px;
        display: flex;
        gap: 4px;
        margin-bottom: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        overflow-x: auto;
        scrollbar-width: thin;
    }

    .reports-tab-nav::-webkit-scrollbar {
        height: 6px;
    }

    .reports-tab-nav::-webkit-scrollbar-thumb {
        background: var(--border-color);
        border-radius: 3px;
    }

    .report-tab-btn {
        flex: 0 0 auto;
        min-width: 140px;
        padding: 12px 15px;
        background: transparent;
        border: none;
        border-radius: 8px;
        color: var(--text-muted);
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: var(--transition);
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        white-space: nowrap;
    }

    .report-tab-btn:hover {
        background: var(--background-light);
        color: var(--text-color);
    }

    .report-tab-btn.active {
        background: var(--primary-color);
        color: white;
    }

    .report-tab-content {
        display: none;
        animation: fadeIn 0.3s ease;
    }

    .report-tab-content.active {
        display: block;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Report Header */
    .report-header {
        background: white;
        border-radius: 12px;
        padding: 20px 24px;
        margin-bottom: 24px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .report-title {
        font-size: 20px;
        font-weight: 600;
        color: var(--text-color);
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .report-actions {
        display: flex;
        gap: 12px;
    }

    /* Filter Section */
    .filter-section {
        background: white;
        border-radius: 12px;
        padding: 16px 24px;
        margin-bottom: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .filter-row {
        display: flex;
        gap: 16px;
        flex-wrap: wrap;
        align-items: center;
    }

    .filter-group {
        display: flex;
        align-items: center;
        gap: 8px;
        flex: 1;
        min-width: 200px;
    }

    .filter-label {
        font-size: 13px;
        color: var(--text-muted);
        font-weight: 500;
        white-space: nowrap;
    }

    .filter-input,
    .filter-select {
        flex: 1;
        padding: 8px 12px;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        background: white;
        font-size: 13px;
        color: var(--text-color);
        transition: var(--transition);
    }

    .filter-input:focus,
    .filter-select:focus {
        border-color: var(--primary-color);
        outline: none;
        box-shadow: 0 0 0 3px rgba(39, 98, 203, 0.1);
    }

    /* Stats Cards Grid */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 20px;
        margin-bottom: 24px;
    }

    .stat-card {
        background: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        transition: var(--transition);
        position: relative;
        overflow: hidden;
    }

    .stat-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 16px rgba(0,0,0,0.1);
    }

    .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 4px;
        height: 100%;
        background: var(--primary-color);
    }

    .stat-card.success::before { background: var(--success-color); }
    .stat-card.warning::before { background: var(--warning-color); }
    .stat-card.danger::before { background: var(--danger-color); }
    .stat-card.info::before { background: var(--info-color); }

    .stat-icon {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 12px;
        font-size: 24px;
    }

    .stat-icon.primary { background: rgba(39, 98, 203, 0.1); color: var(--primary-color); }
    .stat-icon.success { background: var(--success-bg); color: var(--success-color); }
    .stat-icon.warning { background: var(--warning-bg); color: var(--warning-color); }
    .stat-icon.danger { background: rgba(220, 53, 69, 0.1); color: var(--danger-color); }
    .stat-icon.info { background: var(--info-bg); color: var(--info-color); }

    .stat-value {
        font-size: 32px;
        font-weight: 700;
        color: var(--text-color);
        line-height: 1;
        margin-bottom: 8px;
    }

    .stat-label {
        font-size: 13px;
        color: var(--text-muted);
        font-weight: 500;
    }

    .stat-trend {
        display: flex;
        align-items: center;
        gap: 4px;
        margin-top: 12px;
        font-size: 12px;
    }

    .trend-up { color: var(--success-color); }
    .trend-down { color: var(--danger-color); }

    /* Charts Grid */
    .charts-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
        gap: 24px;
        margin-bottom: 24px;
    }

    .chart-card {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .chart-card.full-width {
        grid-column: 1 / -1;
    }

    .chart-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 20px;
    }

    .chart-title {
        font-size: 16px;
        font-weight: 600;
        color: var(--text-color);
    }

    .chart-controls {
        display: flex;
        gap: 8px;
    }

    .chart-btn {
        padding: 6px 12px;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        background: white;
        color: var(--text-muted);
        font-size: 12px;
        cursor: pointer;
        transition: var(--transition);
    }

    .chart-btn:hover {
        background: var(--background-light);
        color: var(--text-color);
        border-color: var(--primary-color);
    }

    .chart-btn.active {
        background: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
    }

    .chart-container {
        position: relative;
        height: 300px;
    }

    /* Data Tables */
    .table-card {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        margin-bottom: 24px;
    }

    .table-header {
        padding: 20px 24px;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: var(--background-light);
    }

    .table-title {
        font-size: 16px;
        font-weight: 600;
        color: var(--text-color);
    }

    .table-search {
        display: flex;
        align-items: center;
        gap: 8px;
        background: white;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 8px 12px;
        min-width: 250px;
    }

    .table-search input {
        border: none;
        background: none;
        outline: none;
        flex: 1;
        font-size: 13px;
        color: var(--text-color);
    }

    .data-table {
        width: 100%;
        border-collapse: collapse;
    }

    .data-table th {
        background: var(--background-light);
        padding: 12px 16px;
        text-align: left;
        font-size: 12px;
        font-weight: 600;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        border-bottom: 2px solid var(--border-color);
    }

    .data-table td {
        padding: 14px 16px;
        border-bottom: 1px solid var(--border-color);
        font-size: 14px;
        color: var(--text-color);
    }

    .data-table tbody tr:hover {
        background: rgba(39, 98, 203, 0.03);
    }

    /* Status Badges */
    .status-badge {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .status-badge.active { background: var(--success-bg); color: var(--success-color); }
    .status-badge.pending { background: var(--warning-bg); color: var(--warning-color); }
    .status-badge.expired { background: rgba(220, 53, 69, 0.1); color: var(--danger-color); }
    .status-badge.draft { background: var(--info-bg); color: var(--info-color); }
    .status-badge.review { background: rgba(115, 180, 224, 0.1); color: var(--secondary-color); }

    /* Risk Heatmap */
    .heatmap-container {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        margin-bottom: 24px;
    }

    .heatmap-grid {
        display: grid;
        grid-template-columns: 100px repeat(5, 1fr);
        gap: 8px;
        margin-top: 20px;
    }

    .heatmap-label {
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: 600;
        color: var(--text-muted);
        padding: 8px;
    }

    .heatmap-cell {
        aspect-ratio: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        border-radius: 8px;
        font-size: 18px;
        font-weight: 700;
        color: white;
        cursor: pointer;
        transition: var(--transition);
        position: relative;
    }

    .heatmap-cell small {
        font-size: 10px;
        font-weight: 500;
        opacity: 0.9;
    }

    .heatmap-cell:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        z-index: 10;
    }

    .risk-very-low { background: #4caf50; }
    .risk-low { background: #8bc34a; }
    .risk-medium { background: #ff9800; }
    .risk-high { background: #ff5722; }
    .risk-critical { background: #f44336; }

    /* Timeline View */
    .timeline-container {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .timeline-item {
        display: flex;
        gap: 16px;
        padding: 16px 0;
        border-bottom: 1px solid var(--border-color);
        position: relative;
    }

    .timeline-item:last-child {
        border-bottom: none;
    }

    .timeline-date {
        flex: 0 0 120px;
        font-size: 13px;
        color: var(--text-muted);
        font-weight: 500;
    }

    .timeline-content {
        flex: 1;
    }

    .timeline-title {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-color);
        margin-bottom: 4px;
    }

    .timeline-desc {
        font-size: 13px;
        color: var(--text-muted);
    }

    /* Gantt Chart */
    .gantt-container {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        overflow-x: auto;
    }

    .gantt-chart {
        min-width: 800px;
    }

    /* Leaderboard */
    .leaderboard-container {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .leaderboard-item {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 8px;
        transition: var(--transition);
    }

    .leaderboard-item:hover {
        background: var(--background-light);
    }

    .leaderboard-rank {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 14px;
    }

    .rank-1 { background: gold; color: white; }
    .rank-2 { background: silver; color: white; }
    .rank-3 { background: #cd7f32; color: white; }
    .rank-other { background: var(--background-light); color: var(--text-muted); }

    .leaderboard-user {
        flex: 1;
        font-weight: 500;
    }

    .leaderboard-score {
        font-weight: 600;
        color: var(--primary-color);
    }

    /* Star Rating */
    .star-rating {
        display: flex;
        gap: 4px;
    }

    .star {
        color: #ffc107;
        font-size: 16px;
    }

    .star.empty {
        color: var(--border-color);
    }

    /* Calendar View */
    .calendar-container {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    /* Workflow Diagram */
    .workflow-diagram {
        display: flex;
        align-items: center;
        gap: 24px;
        padding: 24px;
        overflow-x: auto;
    }

    .workflow-stage {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        position: relative;
    }

    .workflow-icon {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        background: var(--background-light);
        border: 2px solid var(--border-color);
    }

    .workflow-stage.active .workflow-icon {
        background: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
    }

    .workflow-stage.completed .workflow-icon {
        background: var(--success-color);
        color: white;
        border-color: var(--success-color);
    }

    .workflow-label {
        font-size: 12px;
        font-weight: 500;
        color: var(--text-muted);
        text-align: center;
    }

    .workflow-arrow {
        position: absolute;
        right: -30px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--border-color);
        font-size: 20px;
    }

    /* Blockchain Ledger View */
    .ledger-container {
        background: #1a1a1a;
        color: #00ff00;
        font-family: 'Courier New', monospace;
        padding: 20px;
        border-radius: 8px;
        overflow-x: auto;
    }

    .ledger-block {
        border: 1px solid #00ff00;
        padding: 12px;
        margin-bottom: 12px;
        border-radius: 4px;
    }

    .ledger-hash {
        color: #00ff00;
        font-size: 12px;
        word-break: break-all;
    }

    /* Export Options */
    .export-options {
        display: flex;
        gap: 12px;
        padding: 20px;
        background: var(--background-light);
        border-top: 1px solid var(--border-color);
    }

    /* Custom Report Builder */
    .report-builder {
        background: white;
        border-radius: 12px;
        padding: 24px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    .builder-section {
        margin-bottom: 24px;
    }

    .builder-section-title {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-color);
        margin-bottom: 12px;
    }

    .metric-checkboxes {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 12px;
    }

    .metric-checkbox {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .charts-grid {
            grid-template-columns: 1fr;
        }
        
        .filter-row {
            flex-direction: column;
        }
        
        .filter-group {
            width: 100%;
        }
        
        .heatmap-grid {
            grid-template-columns: 60px repeat(5, 1fr);
            font-size: 10px;
        }
        
        .report-tab-btn {
            min-width: 120px;
            font-size: 12px;
            padding: 10px 12px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="reports-container">
    <!-- Page Header -->
    <div class="report-header">
        <h1 class="report-title">
            <i class="ti ti-chart-bar"></i>
            Reports & Analytics Dashboard
        </h1>
        <div class="report-actions">
            <button class="btn btn-secondary" onclick="refreshAllReports()">
                <i class="ti ti-refresh"></i>
                Refresh Data
            </button>
            <button class="btn btn-primary" onclick="openExportModal()">
                <i class="ti ti-download"></i>
                Export
            </button>
        </div>
    </div>

    <!-- Tab Navigation -->
    <div class="reports-tab-nav">
        <button class="report-tab-btn active" onclick="switchReportTab('lifecycle')" data-tab="lifecycle">
            <i class="ti ti-timeline"></i>
            Contract Lifecycle
        </button>
        <button class="report-tab-btn" onclick="switchReportTab('risk')" data-tab="risk">
            <i class="ti ti-alert-triangle"></i>
            Risk & Compliance
        </button>
        <button class="report-tab-btn" onclick="switchReportTab('performance')" data-tab="performance">
            <i class="ti ti-trending-up"></i>
            Performance
        </button>
        <button class="report-tab-btn" onclick="switchReportTab('obligations')" data-tab="obligations">
            <i class="ti ti-checklist"></i>
            Obligations
        </button>
        <button class="report-tab-btn" onclick="switchReportTab('correspondence')" data-tab="correspondence">
            <i class="ti ti-mail"></i>
            Correspondence
        </button>
        <button class="report-tab-btn" onclick="switchReportTab('analytics')" data-tab="analytics">
            <i class="ti ti-brain"></i>
            AI Analytics
        </button>
        <button class="report-tab-btn" onclick="switchReportTab('custom')" data-tab="custom">
            <i class="ti ti-adjustments"></i>
            Custom Reports
        </button>
    </div>

    <!-- Tab 1: Contract Lifecycle Reports -->
    <div class="report-tab-content active" id="lifecycle-tab">
        <!-- Filters -->
        <div class="filter-section">
            <div class="filter-row">
                <div class="filter-group">
                    <label class="filter-label">Date Range:</label>
                    <input type="date" class="filter-input" id="lifecycle-start-date">
                    <span>-</span>
                    <input type="date" class="filter-input" id="lifecycle-end-date">
                </div>
                <div class="filter-group">
                    <label class="filter-label">Contract Type:</label>
                    <select class="filter-select">
                        <option>All Types</option>
                        <option>Service Agreement</option>
                        <option>Purchase Order</option>
                        <option>NDA</option>
                        <option>Subcontract</option>
                        <option>Referral Agreement</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Status:</label>
                    <select class="filter-select">
                        <option>All Status</option>
                        <option>Draft</option>
                        <option>Under Review</option>
                        <option>Signed</option>
                        <option>Active</option>
                        <option>Expired</option>
                    </select>
                </div>
                <button class="btn btn-primary">Apply Filters</button>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon primary">
                    <i class="ti ti-file-text"></i>
                </div>
                <div class="stat-value">256</div>
                <div class="stat-label">Active Contracts</div>
                <div class="stat-trend trend-up">
                    <i class="ti ti-trending-up"></i>
                    <!-- 12% from last month -->
                </div>
            </div>
            <div class="stat-card warning">
                <div class="stat-icon warning">
                    <i class="ti ti-clock"></i>
                </div>
                <div class="stat-value">23</div>
                <div class="stat-label">Expiring Soon</div>
                <div class="stat-trend trend-up">
                    <i class="ti ti-trending-up"></i>
                    5 more than last month
                </div>
            </div>
            <div class="stat-card success">
                <div class="stat-icon success">
                    <i class="ti ti-circle-check"></i>
                </div>
                <div class="stat-value">45</div>
                <div class="stat-label">Executed This Month</div>
                <div class="stat-trend trend-up">
                    <i class="ti ti-trending-up"></i>
                    18% increase
                </div>
            </div>
            <div class="stat-card info">
                <div class="stat-icon info">
                    <i class="ti ti-edit"></i>
                </div>
                <div class="stat-value">12</div>
                <div class="stat-label">Under Review</div>
                <div class="stat-trend trend-down">
                    <i class="ti ti-trending-down"></i>
                    3 less than last week
                </div>
            </div>
        </div>

        <!-- Active Contracts Report -->
        <div class="charts-grid">
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Active Contracts per Month</h3>
                    <div class="chart-controls">
                        <button class="chart-btn active">Bar</button>
                        <button class="chart-btn">Line</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="activeContractsChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Contracts by Type</h3>
                    <div class="chart-controls">
                        <button class="chart-btn active">Pie</button>
                        <button class="chart-btn">Donut</button>
                    </div>
                </div>
                <div class="chart-container">
                    <canvas id="contractTypeChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Upcoming Expirations Timeline -->
        <div class="timeline-container">
            <div class="chart-header">
                <h3 class="chart-title">Upcoming Expirations & Renewals</h3>
                <div class="chart-controls">
                    <button class="chart-btn active">Week</button>
                    <button class="chart-btn">Month</button>
                    <button class="chart-btn">Quarter</button>
                </div>
            </div>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-date">Dec 31, 2024</div>
                    <div class="timeline-content">
                        <div class="timeline-title">Service Agreement - Qatar Energy</div>
                        <div class="timeline-desc">Annual maintenance contract expiring • Auto-renewal enabled</div>
                    </div>
                    <span class="status-badge warning">30 days</span>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">Jan 15, 2025</div>
                    <div class="timeline-content">
                        <div class="timeline-title">Consultancy Agreement - Tech Solutions</div>
                        <div class="timeline-desc">Project consulting contract • Renewal pending approval</div>
                    </div>
                    <span class="status-badge pending">45 days</span>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">Feb 01, 2025</div>
                    <div class="timeline-content">
                        <div class="timeline-title">NDA - Global Partners Ltd</div>
                        <div class="timeline-desc">Confidentiality agreement • Manual renewal required</div>
                    </div>
                    <span class="status-badge active">62 days</span>
                </div>
            </div>
        </div>

        <!-- Contract Status Distribution -->
        <div class="chart-card">
            <div class="chart-header">
                <h3 class="chart-title">Contract Status Distribution</h3>
            </div>
            <div class="chart-container">
                <canvas id="statusDistributionChart"></canvas>
            </div>
        </div>

        <!-- Version History & Audit Trail -->
        <div class="table-card">
            <div class="table-header">
                <h3 class="table-title">Version History & Audit Trail</h3>
                <div class="table-search">
                    <i class="ti ti-search"></i>
                    <input type="text" placeholder="Search contract changes...">
                </div>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Contract ID</th>
                        <th>Change Log</th>
                        <th>User</th>
                        <th>Timestamp</th>
                        <th>Version</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>CTR-2024-001</strong></td>
                        <td>Payment terms updated - Net 30 to Net 45</td>
                        <td>John Smith</td>
                        <td>Dec 20, 2024 14:30</td>
                        <td>v2.1</td>
                        <td>
                            <button class="chart-btn" title="View Details">
                                <i class="ti ti-eye"></i>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>CTR-2024-001</strong></td>
                        <td>Liability clause modified</td>
                        <td>Sarah Johnson</td>
                        <td>Dec 19, 2024 10:15</td>
                        <td>v2.0</td>
                        <td>
                            <button class="chart-btn" title="View Details">
                                <i class="ti ti-eye"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Executed Contracts Summary -->
        <div class="chart-card full-width">
            <div class="chart-header">
                <h3 class="chart-title">Executed Contracts Over Time</h3>
                <div class="chart-controls">
                    <button class="chart-btn">Daily</button>
                    <button class="chart-btn active">Monthly</button>
                    <button class="chart-btn">Yearly</button>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="executedContractsChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Tab 2: Risk & Compliance Reports -->
    <div class="report-tab-content" id="risk-tab">
        <!-- Risk Stats -->
        <div class="stats-grid">
            <div class="stat-card danger">
                <div class="stat-icon danger">
                    <i class="ti ti-alert-triangle"></i>
                </div>
                <div class="stat-value">15</div>
                <div class="stat-label">High Risk Contracts</div>
            </div>
            <div class="stat-card warning">
                <div class="stat-icon warning">
                    <i class="ti ti-flag"></i>
                </div>
                <div class="stat-value">32</div>
                <div class="stat-label">Red Flags Detected</div>
            </div>
            <div class="stat-card success">
                <div class="stat-icon success">
                    <i class="ti ti-shield-check"></i>
                </div>
                <div class="stat-value">89%</div>
                <div class="stat-label">Compliance Rate</div>
            </div>
            <div class="stat-card info">
                <div class="stat-icon info">
                    <i class="ti ti-scale"></i>
                </div>
                <div class="stat-value">7</div>
                <div class="stat-label">Pending Legal Review</div>
            </div>
        </div>

        <!-- AI Risk Assessment Heatmap -->
        <div class="heatmap-container">
            <h3 class="chart-title">AI-Based Risk Assessment Heatmap</h3>
            <div class="heatmap-grid">
                <div class="heatmap-label">Risk Type</div>
                <div class="heatmap-label">Very Low</div>
                <div class="heatmap-label">Low</div>
                <div class="heatmap-label">Medium</div>
                <div class="heatmap-label">High</div>
                <div class="heatmap-label">Critical</div>
                
                <div class="heatmap-label">Service Agreement</div>
                <div class="heatmap-cell risk-very-low">12<small>contracts</small></div>
                <div class="heatmap-cell risk-low">18<small>contracts</small></div>
                <div class="heatmap-cell risk-medium">8<small>contracts</small></div>
                <div class="heatmap-cell risk-high">3<small>contracts</small></div>
                <div class="heatmap-cell risk-critical">1<small>contract</small></div>
                
                <div class="heatmap-label">Purchase Order</div>
                <div class="heatmap-cell risk-very-low">25<small>contracts</small></div>
                <div class="heatmap-cell risk-low">30<small>contracts</small></div>
                <div class="heatmap-cell risk-medium">12<small>contracts</small></div>
                <div class="heatmap-cell risk-high">5<small>contracts</small></div>
                <div class="heatmap-cell risk-critical">0<small>contracts</small></div>
                
                <div class="heatmap-label">NDA</div>
                <div class="heatmap-cell risk-very-low">45<small>contracts</small></div>
                <div class="heatmap-cell risk-low">22<small>contracts</small></div>
                <div class="heatmap-cell risk-medium">6<small>contracts</small></div>
                <div class="heatmap-cell risk-high">2<small>contracts</small></div>
                <div class="heatmap-cell risk-critical">0<small>contracts</small></div>
                
                <div class="heatmap-label">Subcontract</div>
                <div class="heatmap-cell risk-very-low">8<small>contracts</small></div>
                <div class="heatmap-cell risk-low">15<small>contracts</small></div>
                <div class="heatmap-cell risk-medium">20<small>contracts</small></div>
                <div class="heatmap-cell risk-high">10<small>contracts</small></div>
                <div class="heatmap-cell risk-critical">3<small>contracts</small></div>
            </div>
        </div>

        <!-- Red Flags & Non-Compliance -->
        <div class="charts-grid">
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Red Flags per Contract Category</h3>
                </div>
                <div class="chart-container">
                    <canvas id="redFlagsChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Jurisdiction-Specific Compliance</h3>
                </div>
                <div class="chart-container">
                    <canvas id="complianceMapChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Obligations & Liabilities Timeline -->
        <div class="chart-card full-width">
            <div class="chart-header">
                <h3 class="chart-title">Contractual Obligations & Liabilities Timeline</h3>
            </div>
            <div class="chart-container">
                <canvas id="obligationsTimelineChart"></canvas>
            </div>
        </div>

        <!-- Breach & Dispute Tracker -->
        <div class="table-card">
            <div class="table-header">
                <h3 class="table-title">Breach & Dispute Tracker</h3>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Contract ID</th>
                        <th>Breach Type</th>
                        <th>Severity</th>
                        <th>Date Reported</th>
                        <th>Resolution Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>CTR-2024-045</strong></td>
                        <td>Payment Delay</td>
                        <td><span class="status-badge warning">Medium</span></td>
                        <td>Dec 15, 2024</td>
                        <td><span class="status-badge pending">In Progress</span></td>
                        <td>
                            <button class="chart-btn"><i class="ti ti-eye"></i></button>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>CTR-2024-032</strong></td>
                        <td>Non-Delivery</td>
                        <td><span class="status-badge danger">High</span></td>
                        <td>Dec 10, 2024</td>
                        <td><span class="status-badge active">Resolved</span></td>
                        <td>
                            <button class="chart-btn"><i class="ti ti-eye"></i></button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Tab 3: Performance & Efficiency Reports -->
    <div class="report-tab-content" id="performance-tab">
        <!-- Performance Stats -->
        <div class="stats-grid">
            <div class="stat-card success">
                <div class="stat-icon success">
                    <i class="ti ti-clock"></i>
                </div>
                <div class="stat-value">4.2</div>
                <div class="stat-label">Avg Turnaround (Days)</div>
                <div class="stat-trend trend-down">
                    <i class="ti ti-trending-down"></i>
                    20% faster
                </div>
            </div>
            <div class="stat-card primary">
                <div class="stat-icon primary">
                    <i class="ti ti-message-circle"></i>
                </div>
                <div class="stat-value">3.5</div>
                <div class="stat-label">Avg Negotiation Rounds</div>
            </div>
            <div class="stat-card warning">
                <div class="stat-icon warning">
                    <i class="ti ti-hourglass"></i>
                </div>
                <div class="stat-value">8</div>
                <div class="stat-label">Approval Delays</div>
            </div>
            <div class="stat-card info">
                <div class="stat-icon info">
                    <i class="ti ti-percentage"></i>
                </div>
                <div class="stat-value">92%</div>
                <div class="stat-label">Clause Acceptance Rate</div>
            </div>
        </div>

        <!-- Contract Turnaround Time -->
        <div class="chart-card full-width">
            <div class="chart-header">
                <h3 class="chart-title">Contract Turnaround Time Trend</h3>
            </div>
            <div class="chart-container">
                <canvas id="turnaroundChart"></canvas>
            </div>
        </div>

        <!-- Most Negotiated Clauses -->
        <div class="charts-grid">
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Most Negotiated Clauses</h3>
                </div>
                <div class="chart-container">
                    <canvas id="negotiatedClausesChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Clause Acceptance/Rejection Funnel</h3>
                </div>
                <div class="chart-container">
                    <canvas id="clauseFunnelChart"></canvas>
                </div>
            </div>
        </div>

        <!-- User Activity Leaderboard -->
        <div class="leaderboard-container">
            <h3 class="chart-title">User Activity & Performance Leaderboard</h3>
            <div class="leaderboard-item">
                <div class="leaderboard-rank rank-1">1</div>
                <div class="leaderboard-user">John Smith</div>
                <div class="leaderboard-score">156 Contracts Handled</div>
            </div>
            <div class="leaderboard-item">
                <div class="leaderboard-rank rank-2">2</div>
                <div class="leaderboard-user">Sarah Johnson</div>
                <div class="leaderboard-score">142 Contracts Handled</div>
            </div>
            <div class="leaderboard-item">
                <div class="leaderboard-rank rank-3">3</div>
                <div class="leaderboard-user">Mike Davis</div>
                <div class="leaderboard-score">128 Contracts Handled</div>
            </div>
            <div class="leaderboard-item">
                <div class="leaderboard-rank rank-other">4</div>
                <div class="leaderboard-user">Emily Brown</div>
                <div class="leaderboard-score">115 Contracts Handled</div>
            </div>
        </div>

        <!-- Approval Delays Gantt Chart -->
        <div class="gantt-container">
            <h3 class="chart-title">Contract Approval Delays - Gantt View</h3>
            <div class="gantt-chart">
                <canvas id="ganttChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Tab 4: Obligations & Milestone Tracking -->
    <div class="report-tab-content" id="obligations-tab">
        <!-- Obligations Stats -->
        <div class="stats-grid">
            <div class="stat-card primary">
                <div class="stat-icon primary">
                    <i class="ti ti-checklist"></i>
                </div>
                <div class="stat-value">142</div>
                <div class="stat-label">Active Obligations</div>
            </div>
            <div class="stat-card warning">
                <div class="stat-icon warning">
                    <i class="ti ti-clock"></i>
                </div>
                <div class="stat-value">28</div>
                <div class="stat-label">Due This Week</div>
            </div>
            <div class="stat-card danger">
                <div class="stat-icon danger">
                    <i class="ti ti-alert-circle"></i>
                </div>
                <div class="stat-value">5</div>
                <div class="stat-label">Overdue</div>
            </div>
            <div class="stat-card success">
                <div class="stat-icon success">
                    <i class="ti ti-circle-check"></i>
                </div>
                <div class="stat-value">87%</div>
                <div class="stat-label">Completion Rate</div>
            </div>
        </div>

        <!-- Deliverables Timeline -->
        <div class="chart-card full-width">
            <div class="chart-header">
                <h3 class="chart-title">Contract Deliverables & Milestones Timeline</h3>
            </div>
            <div class="chart-container">
                <canvas id="deliverablesTimelineChart"></canvas>
            </div>
        </div>

        <!-- Vendor Performance -->
        <div class="table-card">
            <div class="table-header">
                <h3 class="table-title">Vendor & Supplier Performance</h3>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Vendor Name</th>
                        <th>Contract Count</th>
                        <th>Success Rate</th>
                        <th>Avg Delivery Time</th>
                        <th>Performance Score</th>
                        <th>Rating</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Tech Solutions Ltd</strong></td>
                        <td>23</td>
                        <td>95.6%</td>
                        <td>2.3 days early</td>
                        <td>92/100</td>
                        <td>
                            <div class="star-rating">
                                <i class="ti ti-star-filled star"></i>
                                <i class="ti ti-star-filled star"></i>
                                <i class="ti ti-star-filled star"></i>
                                <i class="ti ti-star-filled star"></i>
                                <i class="ti ti-star-half-filled star"></i>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Global Supplies Inc</strong></td>
                        <td>18</td>
                        <td>88.2%</td>
                        <td>On time</td>
                        <td>85/100</td>
                        <td>
                            <div class="star-rating">
                                <i class="ti ti-star-filled star"></i>
                                <i class="ti ti-star-filled star"></i>
                                <i class="ti ti-star-filled star"></i>
                                <i class="ti ti-star-filled star"></i>
                                <i class="ti ti-star star empty"></i>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Missed Obligations -->
        <div class="table-card">
            <div class="table-header">
                <h3 class="table-title">Missed Obligations & Delays - Red Flag Alerts</h3>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Obligation ID</th>
                        <th>Contract</th>
                        <th>Description</th>
                        <th>Due Date</th>
                        <th>Days Overdue</th>
                        <th>Impact</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>OBL-2024-089</strong></td>
                        <td>CTR-2024-015</td>
                        <td>Quarterly Compliance Report</td>
                        <td>Dec 15, 2024</td>
                        <td><span class="status-badge danger">5 days</span></td>
                        <td>High</td>
                        <td>
                            <button class="btn btn-sm btn-danger">Escalate</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Recurring Commitments Calendar -->
        <div class="calendar-container">
            <h3 class="chart-title">Recurring Commitments - Calendar View</h3>
            <div id="recurringCalendar">
                <!-- Calendar implementation would go here -->
                <div style="padding: 40px; text-align: center; color: var(--text-muted);">
                    <i class="ti ti-calendar" style="font-size: 48px;"></i>
                    <p>Interactive Calendar View</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab 5: Correspondence & Communication -->
    <div class="report-tab-content" id="correspondence-tab">
        <!-- Communication Stats -->
        <div class="stats-grid">
            <div class="stat-card primary">
                <div class="stat-icon primary">
                    <i class="ti ti-mail"></i>
                </div>
                <div class="stat-value">342</div>
                <div class="stat-label">Total Communications</div>
            </div>
            <div class="stat-card success">
                <div class="stat-icon success">
                    <i class="ti ti-mail-opened"></i>
                </div>
                <div class="stat-value">298</div>
                <div class="stat-label">Resolved Queries</div>
            </div>
            <div class="stat-card warning">
                <div class="stat-icon warning">
                    <i class="ti ti-clock"></i>
                </div>
                <div class="stat-value">2.4h</div>
                <div class="stat-label">Avg Response Time</div>
            </div>
            <div class="stat-card info">
                <div class="stat-icon info">
                    <i class="ti ti-message-2"></i>
                </div>
                <div class="stat-value">44</div>
                <div class="stat-label">Pending Responses</div>
            </div>
        </div>

        <!-- Correspondence Summary -->
        <div class="table-card">
            <div class="table-header">
                <h3 class="table-title">Correspondence Summary</h3>
                <div class="table-search">
                    <i class="ti ti-search"></i>
                    <input type="text" placeholder="Search emails...">
                </div>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Contract ID</th>
                        <th>Subject</th>
                        <th>From/To</th>
                        <th>Date</th>
                        <th>Type</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>CTR-2024-001</strong></td>
                        <td>Payment Terms Clarification</td>
                        <td>Qatar Energy</td>
                        <td>Dec 20, 2024</td>
                        <td>Query</td>
                        <td><span class="status-badge active">Responded</span></td>
                        <td>
                            <button class="chart-btn"><i class="ti ti-eye"></i></button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Amendments Chart -->
        <div class="chart-card full-width">
            <div class="chart-header">
                <h3 class="chart-title">Contract Amendments & Changes Over Time</h3>
            </div>
            <div class="chart-container">
                <canvas id="amendmentsChart"></canvas>
            </div>
        </div>

        <!-- Legal Notices & Response Times -->
        <div class="charts-grid">
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Response Speed by Counterparty</h3>
                </div>
                <div class="chart-container">
                    <canvas id="responseSpeedChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Escalation Workflow Status</h3>
                </div>
                <div class="workflow-diagram">
                    <div class="workflow-stage completed">
                        <div class="workflow-icon">
                            <i class="ti ti-mail"></i>
                        </div>
                        <div class="workflow-label">Initial Query</div>
                        <i class="ti ti-arrow-right workflow-arrow"></i>
                    </div>
                    <div class="workflow-stage completed">
                        <div class="workflow-icon">
                            <i class="ti ti-user-check"></i>
                        </div>
                        <div class="workflow-label">L1 Review</div>
                        <i class="ti ti-arrow-right workflow-arrow"></i>
                    </div>
                    <div class="workflow-stage active">
                        <div class="workflow-icon">
                            <i class="ti ti-users"></i>
                        </div>
                        <div class="workflow-label">L2 Escalation</div>
                        <i class="ti ti-arrow-right workflow-arrow"></i>
                    </div>
                    <div class="workflow-stage">
                        <div class="workflow-icon">
                            <i class="ti ti-briefcase"></i>
                        </div>
                        <div class="workflow-label">Legal Team</div>
                        <i class="ti ti-arrow-right workflow-arrow"></i>
                    </div>
                    <div class="workflow-stage">
                        <div class="workflow-icon">
                            <i class="ti ti-check"></i>
                        </div>
                        <div class="workflow-label">Resolved</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab 6: Smart Analytics & AI-Driven Insights -->
    <div class="report-tab-content" id="analytics-tab">
        <!-- AI Analytics Stats -->
        <div class="stats-grid">
            <div class="stat-card primary">
                <div class="stat-icon primary">
                    <i class="ti ti-brain"></i>
                </div>
                <div class="stat-value">94%</div>
                <div class="stat-label">AI Accuracy</div>
            </div>
            <div class="stat-card success">
                <div class="stat-icon success">
                    <i class="ti ti-bulb"></i>
                </div>
                <div class="stat-value">156</div>
                <div class="stat-label">AI Recommendations</div>
            </div>
            <div class="stat-card warning">
                <div class="stat-icon warning">
                    <i class="ti ti-trending-down"></i>
                </div>
                <div class="stat-value">23%</div>
                <div class="stat-label">Risk Reduction</div>
            </div>
            <div class="stat-card info">
                <div class="stat-icon info">
                    <i class="ti ti-shield"></i>
                </div>
                <div class="stat-value">8</div>
                <div class="stat-label">Disputes Prevented</div>
            </div>
        </div>

        <!-- Predictive Risk Analysis -->
        <div class="heatmap-container">
            <h3 class="chart-title">Predictive Contract Risk & Liability - AI Analysis</h3>
            <div style="padding: 20px;">
                <div style="display: grid; gap: 12px;">
                    <div style="padding: 16px; background: var(--danger-bg); border-left: 4px solid var(--danger-color); border-radius: 8px;">
                        <strong>CTR-2024-045:</strong> Payment terms clause has 78% probability of dispute
                        <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                            Recommendation: Add late payment penalties and clarify payment schedule
                        </div>
                    </div>
                    <div style="padding: 16px; background: var(--warning-bg); border-left: 4px solid var(--warning-color); border-radius: 8px;">
                        <strong>CTR-2024-067:</strong> Force majeure clause may not comply with local regulations
                        <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                            Recommendation: Update to include pandemic-related events
                        </div>
                    </div>
                    <div style="padding: 16px; background: var(--info-bg); border-left: 4px solid var(--info-color); border-radius: 8px;">
                        <strong>CTR-2024-089:</strong> Missing critical indemnification terms
                        <div style="font-size: 12px; color: var(--text-muted); margin-top: 4px;">
                            Recommendation: Add mutual indemnification clause
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Market & Clause Trends -->
        <div class="charts-grid">
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">AI-Powered Market & Clause Trends</h3>
                </div>
                <div class="chart-container">
                    <canvas id="clauseTrendsChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Industry Benchmark Comparison</h3>
                </div>
                <div class="chart-container">
                    <canvas id="benchmarkChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Decision-Making Dashboard -->
        <div class="chart-card full-width">
            <h3 class="chart-title">AI Decision-Making Recommendations</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px; padding: 16px;">
                <div style="padding: 16px; background: var(--background-light); border-radius: 8px;">
                    <h4 style="color: var(--primary-color); margin-bottom: 8px;">Contract Optimization</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li style="padding: 4px 0;">✓ Standardize payment terms to Net 30</li>
                        <li style="padding: 4px 0;">✓ Include automatic renewal clauses</li>
                        <li style="padding: 4px 0;">✓ Add inflation adjustment provisions</li>
                    </ul>
                </div>
                <div style="padding: 16px; background: var(--background-light); border-radius: 8px;">
                    <h4 style="color: var(--primary-color); margin-bottom: 8px;">Risk Mitigation</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li style="padding: 4px 0;">⚠ Review liability caps in 15 contracts</li>
                        <li style="padding: 4px 0;">⚠ Update force majeure clauses</li>
                        <li style="padding: 4px 0;">⚠ Add cyber security provisions</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Blockchain Audit Log -->
        <div class="chart-card full-width">
            <h3 class="chart-title">Blockchain Audit Log - Immutable Ledger View</h3>
            <div class="ledger-container">
                <div class="ledger-block">
                    <div>Block #: 1247856</div>
                    <div>Contract: CTR-2024-001</div>
                    <div>Action: Contract Signed</div>
                    <div>Timestamp: 2024-12-20 14:30:45 UTC</div>
                    <div class="ledger-hash">Hash: 0x3f4a8b2c9d1e7f6a5b4c3d2e1f0a9b8c7d6e5f4a3b2c1d0e9f8a7b6c5d4e3f2a1b</div>
                </div>
                <div class="ledger-block">
                    <div>Block #: 1247857</div>
                    <div>Contract: CTR-2024-002</div>
                    <div>Action: Amendment Added</div>
                    <div>Timestamp: 2024-12-20 15:45:12 UTC</div>
                    <div class="ledger-hash">Hash: 0x2e3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5f6a7b8c9d0e1f2a3b4c</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab 7: Custom Reports -->
    <div class="report-tab-content" id="custom-tab">
        <div class="report-builder">
            <h3 class="chart-title">User-Defined Custom Report Builder</h3>
            
            <!-- Report Configuration -->
            <div class="builder-section">
                <div class="builder-section-title">Report Configuration</div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">
                    <div class="filter-group">
                        <label class="filter-label">Report Name:</label>
                        <input type="text" class="filter-input" placeholder="Enter report name">
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Report Type:</label>
                        <select class="filter-select">
                            <option>Contract Summary</option>
                            <option>Risk Analysis</option>
                            <option>Performance Metrics</option>
                            <option>Compliance Status</option>
                            <option>Financial Overview</option>
                            <option>Vendor Analysis</option>
                            <option>Obligation Tracking</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Date Range:</label>
                        <select class="filter-select">
                            <option>Last 7 Days</option>
                            <option>Last 30 Days</option>
                            <option>Last Quarter</option>
                            <option>Last Year</option>
                            <option>Custom Range</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Department:</label>
                        <select class="filter-select">
                            <option>All Departments</option>
                            <option>Legal</option>
                            <option>Finance</option>
                            <option>Operations</option>
                            <option>Procurement</option>
                            <option>HR</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Dynamic Filters -->
            <div class="builder-section">
                <div class="builder-section-title">Dynamic Filters</div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
                    <div class="filter-group">
                        <label class="filter-label">Contract Type:</label>
                        <select class="filter-select" multiple style="height: 100px;">
                            <option selected>Service Agreement</option>
                            <option selected>Purchase Order</option>
                            <option>NDA</option>
                            <option>Subcontract</option>
                            <option>Referral Agreement</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Contract Status:</label>
                        <select class="filter-select" multiple style="height: 100px;">
                            <option selected>Active</option>
                            <option selected>Signed</option>
                            <option>Draft</option>
                            <option>Under Review</option>
                            <option>Expired</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Risk Level:</label>
                        <select class="filter-select" multiple style="height: 100px;">
                            <option>Very Low</option>
                            <option selected>Low</option>
                            <option selected>Medium</option>
                            <option>High</option>
                            <option>Critical</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label class="filter-label">Value Range:</label>
                        <select class="filter-select">
                            <option>All Values</option>
                            <option>< $10,000</option>
                            <option>$10,000 - $50,000</option>
                            <option>$50,000 - $100,000</option>
                            <option>$100,000 - $500,000</option>
                            <option>> $500,000</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Metrics Selection -->
            <div class="builder-section">
                <div class="builder-section-title">Select Metrics to Include</div>
                <div class="metric-checkboxes">
                    <label class="metric-checkbox">
                        <input type="checkbox" checked> Contract Count
                    </label>
                    <label class="metric-checkbox">
                        <input type="checkbox" checked> Total Contract Value
                    </label>
                    <label class="metric-checkbox">
                        <input type="checkbox"> Average Contract Duration
                    </label>
                    <label class="metric-checkbox">
                        <input type="checkbox" checked> Risk Score
                    </label>
                    <label class="metric-checkbox">
                        <input type="checkbox"> Compliance Rate
                    </label>
                    <label class="metric-checkbox">
                        <input type="checkbox"> Turnaround Time
                    </label>
                    <label class="metric-checkbox">
                        <input type="checkbox" checked> Approval Status
                    </label>
                    <label class="metric-checkbox">
                        <input type="checkbox"> Obligation Count
                    </label>
                    <label class="metric-checkbox">
                        <input type="checkbox"> Amendment Count
                    </label>
                    <label class="metric-checkbox">
                        <input type="checkbox"> Vendor Performance
                    </label>
                </div>
            </div>

            <!-- Visualization Options -->
            <div class="builder-section">
                <div class="builder-section-title">Custom Graphs & Visualization</div>
                <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                    <button class="chart-btn">
                        <i class="ti ti-chart-bar"></i> Bar Chart
                    </button>
                    <button class="chart-btn active">
                        <i class="ti ti-chart-line"></i> Line Chart
                    </button>
                    <button class="chart-btn">
                        <i class="ti ti-chart-pie"></i> Pie Chart
                    </button>
                    <button class="chart-btn">
                        <i class="ti ti-chart-donut"></i> Donut Chart
                    </button>
                    <button class="chart-btn">
                        <i class="ti ti-table"></i> Table View
                    </button>
                    <button class="chart-btn">
                        <i class="ti ti-chart-radar"></i> Radar Chart
                    </button>
                    <button class="chart-btn">
                        <i class="ti ti-map"></i> Geo Map
                    </button>
                    <button class="chart-btn">
                        <i class="ti ti-timeline"></i> Timeline
                    </button>
                </div>
            </div>

            <!-- Export Options -->
            <div class="builder-section">
                <div class="builder-section-title">Data Export Options</div>
                <div style="display: flex; gap: 12px; align-items: center;">
                    <button class="btn btn-secondary">
                        <i class="ti ti-file-spreadsheet"></i> Export to Excel
                    </button>
                    <button class="btn btn-secondary">
                        <i class="ti ti-file-text"></i> Export to PDF
                    </button>
                    <button class="btn btn-secondary">
                        <i class="ti ti-file-export"></i> Export to CSV
                    </button>
                    <button class="btn btn-secondary">
                        <i class="ti ti-printer"></i> Print Report
                    </button>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="builder-section" style="border-top: 1px solid var(--border-color); padding-top: 20px;">
                <div style="display: flex; gap: 12px; justify-content: flex-end;">
                    <button class="btn btn-secondary">
                        <i class="ti ti-device-floppy"></i> Save Template
                    </button>
                    <button class="btn btn-secondary">
                        <i class="ti ti-calendar-event"></i> Schedule Report
                    </button>
                    <button class="btn btn-secondary">
                        <i class="ti ti-share"></i> Share Report
                    </button>
                    <button class="btn btn-primary">
                        <i class="ti ti-play"></i> Generate Report
                    </button>
                </div>
            </div>
        </div>

        <!-- Ad-Hoc Report Results -->
        <div class="chart-card" style="margin-top: 24px;">
            <div class="chart-header">
                <h3 class="chart-title">Generated Custom Report</h3>
                <div class="chart-controls">
                    <button class="chart-btn" onclick="refreshCustomReport()">
                        <i class="ti ti-refresh"></i> Refresh
                    </button>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="customReportChart"></canvas>
            </div>
        </div>

        <!-- Saved Templates -->
        <div class="table-card">
            <div class="table-header">
                <h3 class="table-title">Saved Report Templates</h3>
                <button class="btn btn-primary">
                    <i class="ti ti-plus"></i> New Template
                </button>
            </div>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Template Name</th>
                        <th>Report Type</th>
                        <th>Created By</th>
                        <th>Last Modified</th>
                        <th>Schedule</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Monthly Executive Summary</strong></td>
                        <td>Contract Summary</td>
                        <td>Admin User</td>
                        <td>Dec 15, 2024</td>
                        <td><span class="status-badge active">Monthly - 1st</span></td>
                        <td>
                            <button class="chart-btn" title="Run Report">
                                <i class="ti ti-play"></i>
                            </button>
                            <button class="chart-btn" title="Edit Template">
                                <i class="ti ti-edit"></i>
                            </button>
                            <button class="chart-btn" title="Delete">
                                <i class="ti ti-trash"></i>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Weekly Risk Assessment</strong></td>
                        <td>Risk Analysis</td>
                        <td>Legal Team</td>
                        <td>Dec 18, 2024</td>
                        <td><span class="status-badge active">Weekly - Monday</span></td>
                        <td>
                            <button class="chart-btn" title="Run Report">
                                <i class="ti ti-play"></i>
                            </button>
                            <button class="chart-btn" title="Edit Template">
                                <i class="ti ti-edit"></i>
                            </button>
                            <button class="chart-btn" title="Delete">
                                <i class="ti ti-trash"></i>
                            </button>
                        </td>
                    </tr>
                    <tr>
                        <td><strong>Quarterly Performance Review</strong></td>
                        <td>Performance Metrics</td>
                        <td>Operations Manager</td>
                        <td>Dec 10, 2024</td>
                        <td><span class="status-badge pending">Quarterly</span></td>
                        <td>
                            <button class="chart-btn" title="Run Report">
                                <i class="ti ti-play"></i>
                            </button>
                            <button class="chart-btn" title="Edit Template">
                                <i class="ti ti-edit"></i>
                            </button>
                            <button class="chart-btn" title="Delete">
                                <i class="ti ti-trash"></i>
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Tab Switching
    function switchReportTab(tabName) {
        // Hide all tabs
        document.querySelectorAll('.report-tab-content').forEach(tab => {
            tab.classList.remove('active');
        });
        
        // Remove active class from all buttons
        document.querySelectorAll('.report-tab-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        
        // Show selected tab
        document.getElementById(tabName + '-tab').classList.add('active');
        
        // Add active class to clicked button
        document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        
        // Initialize charts for the active tab
        setTimeout(() => initializeTabCharts(tabName), 100);
    }

    // Initialize Charts based on tab
    function initializeTabCharts(tabName) {
        switch(tabName) {
            case 'lifecycle':
                initializeLifecycleCharts();
                break;
            case 'risk':
                initializeRiskCharts();
                break;
            case 'performance':
                initializePerformanceCharts();
                break;
            case 'obligations':
                initializeObligationsCharts();
                break;
            case 'correspondence':
                initializeCorrespondenceCharts();
                break;
            case 'analytics':
                initializeAnalyticsCharts();
                break;
            case 'custom':
                initializeCustomCharts();
                break;
        }
    }

    // Lifecycle Charts
    function initializeLifecycleCharts() {
        // Active Contracts Chart
        const ctx1 = document.getElementById('activeContractsChart');
        if (ctx1) {
            new Chart(ctx1.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'Active Contracts',
                        data: [120, 135, 142, 138, 155, 162, 178, 185, 198, 210, 235, 256],
                        backgroundColor: 'rgba(39, 98, 203, 0.8)',
                        borderColor: '#2762cb',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Contract Type Pie Chart
        const ctx2 = document.getElementById('contractTypeChart');
        if (ctx2) {
            new Chart(ctx2.getContext('2d'), {
                type: 'pie',
                data: {
                    labels: ['Service Agreement', 'Purchase Order', 'NDA', 'Subcontract', 'Other'],
                    datasets: [{
                        data: [35, 25, 20, 15, 5],
                        backgroundColor: [
                            '#2762cb',
                            '#73B4E0',
                            '#28a745',
                            '#ffc107',
                            '#dc3545'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // Status Distribution Donut Chart
        const ctx3 = document.getElementById('statusDistributionChart');
        if (ctx3) {
            new Chart(ctx3.getContext('2d'), {
                type: 'doughnut',
                data: {
                    labels: ['Draft', 'Review', 'Signed', 'Active', 'Expired'],
                    datasets: [{
                        data: [12, 8, 45, 256, 23],
                        backgroundColor: [
                            '#0c5460',
                            '#73B4E0',
                            '#28a745',
                            '#2762cb',
                            '#dc3545'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // Executed Contracts Line Chart
        const ctx4 = document.getElementById('executedContractsChart');
        if (ctx4) {
            new Chart(ctx4.getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'Executed Contracts',
                        data: [32, 28, 35, 42, 38, 45, 52, 48, 55, 58, 62, 45],
                        borderColor: '#28a745',
                        backgroundColor: 'rgba(40, 167, 69, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }
    }

    // Risk Charts
    function initializeRiskCharts() {
        // Red Flags Chart
        const ctx1 = document.getElementById('redFlagsChart');
        if (ctx1) {
            new Chart(ctx1.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['Payment Terms', 'Liability', 'Termination', 'IP Rights', 'Confidentiality', 'Force Majeure'],
                    datasets: [{
                        label: 'Red Flags',
                        data: [12, 8, 5, 7, 3, 6],
                        backgroundColor: '#dc3545'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y'
                }
            });
        }

        // Compliance Map
        const ctx2 = document.getElementById('complianceMapChart');
        if (ctx2) {
            new Chart(ctx2.getContext('2d'), {
                type: 'radar',
                data: {
                    labels: ['Qatar', 'UAE', 'Saudi Arabia', 'Kuwait', 'Bahrain', 'Oman'],
                    datasets: [{
                        label: 'Compliance Score',
                        data: [95, 88, 92, 85, 90, 87],
                        borderColor: '#28a745',
                        backgroundColor: 'rgba(40, 167, 69, 0.2)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        // Obligations Timeline
        const ctx3 = document.getElementById('obligationsTimelineChart');
        if (ctx3) {
            new Chart(ctx3.getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6', 'Week 7', 'Week 8'],
                    datasets: [{
                        label: 'Obligations Due',
                        data: [5, 8, 12, 7, 15, 10, 8, 6],
                        borderColor: '#2762cb',
                        backgroundColor: 'rgba(39, 98, 203, 0.1)',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }
    }

    // Performance Charts
    function initializePerformanceCharts() {
        // Turnaround Time Chart
        const ctx1 = document.getElementById('turnaroundChart');
        if (ctx1) {
            new Chart(ctx1.getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'Turnaround Time (Days)',
                        data: [8.5, 7.2, 6.8, 5.5, 4.8, 4.2, 4.0, 3.8, 3.5, 3.8, 4.0, 4.2],
                        borderColor: '#2762cb',
                        backgroundColor: 'rgba(39, 98, 203, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // Most Negotiated Clauses
        const ctx2 = document.getElementById('negotiatedClausesChart');
        if (ctx2) {
            new Chart(ctx2.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['Payment Terms', 'Liability Cap', 'Termination', 'IP Rights', 'Warranty', 'Indemnity'],
                    datasets: [{
                        label: 'Frequency of Edits',
                        data: [45, 38, 32, 28, 25, 22],
                        backgroundColor: '#73B4E0'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // Clause Acceptance Funnel
        const ctx3 = document.getElementById('clauseFunnelChart');
        if (ctx3) {
            new Chart(ctx3.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['Proposed', 'Reviewed', 'Negotiated', 'Accepted', 'Finalized'],
                    datasets: [{
                        label: 'Clauses',
                        data: [100, 85, 60, 52, 48],
                        backgroundColor: [
                            'rgba(39, 98, 203, 0.8)',
                            'rgba(115, 180, 224, 0.8)',
                            'rgba(255, 193, 7, 0.8)',
                            'rgba(40, 167, 69, 0.8)',
                            'rgba(40, 167, 69, 1)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y'
                }
            });
        }

        // Gantt Chart for Approval Delays
        const ctx4 = document.getElementById('ganttChart');
        if (ctx4) {
            new Chart(ctx4.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['CTR-001', 'CTR-002', 'CTR-003', 'CTR-004', 'CTR-005'],
                    datasets: [
                        {
                            label: 'Expected',
                            data: [5, 7, 6, 8, 5],
                            backgroundColor: 'rgba(40, 167, 69, 0.5)'
                        },
                        {
                            label: 'Actual',
                            data: [8, 12, 7, 15, 6],
                            backgroundColor: 'rgba(220, 53, 69, 0.5)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y'
                }
            });
        }
    }

    // Obligations Charts
    function initializeObligationsCharts() {
        // Deliverables Timeline
        const ctx1 = document.getElementById('deliverablesTimelineChart');
        if (ctx1) {
            new Chart(ctx1.getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6', 'Week 7', 'Week 8'],
                    datasets: [{
                        label: 'Deliverables Due',
                        data: [3, 5, 8, 4, 12, 7, 5, 9],
                        borderColor: '#2762cb',
                        backgroundColor: 'rgba(39, 98, 203, 0.1)',
                        fill: true
                    },
                    {
                        label: 'Completed',
                        data: [3, 4, 7, 4, 10, 6, 5, 8],
                        borderColor: '#28a745',
                        backgroundColor: 'rgba(40, 167, 69, 0.1)',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }
    }

    // Correspondence Charts
    function initializeCorrespondenceCharts() {
        // Amendments Over Time
        const ctx1 = document.getElementById('amendmentsChart');
        if (ctx1) {
            new Chart(ctx1.getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'Amendments',
                        data: [5, 8, 6, 12, 10, 15, 13, 18, 16, 20, 19, 22],
                        borderColor: '#856404',
                        backgroundColor: 'rgba(133, 100, 4, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // Response Speed by Counterparty
        const ctx2 = document.getElementById('responseSpeedChart');
        if (ctx2) {
            new Chart(ctx2.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['Qatar Energy', 'Tech Solutions', 'Global Partners', 'ABC Corp', 'XYZ Ltd'],
                    datasets: [{
                        label: 'Avg Response Time (Hours)',
                        data: [2.4, 3.8, 1.5, 4.2, 2.8],
                        backgroundColor: [
                            'rgba(40, 167, 69, 0.8)',
                            'rgba(255, 193, 7, 0.8)',
                            'rgba(40, 167, 69, 0.8)',
                            'rgba(220, 53, 69, 0.8)',
                            'rgba(39, 98, 203, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y'
                }
            });
        }
    }

    // Analytics Charts
    function initializeAnalyticsCharts() {
        // Clause Trends
        const ctx1 = document.getElementById('clauseTrendsChart');
        if (ctx1) {
            new Chart(ctx1.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['Force Majeure', 'Remote Work', 'Data Privacy', 'Cybersecurity', 'ESG', 'AI/ML'],
                    datasets: [{
                        label: 'Industry Usage %',
                        data: [95, 78, 88, 72, 65, 45],
                        backgroundColor: '#2762cb'
                    },
                    {
                        label: 'Our Usage %',
                        data: [92, 85, 90, 68, 70, 38],
                        backgroundColor: '#73B4E0'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        // Benchmark Comparison
        const ctx2 = document.getElementById('benchmarkChart');
        if (ctx2) {
            new Chart(ctx2.getContext('2d'), {
                type: 'radar',
                data: {
                    labels: ['Speed', 'Accuracy', 'Compliance', 'Risk Mgmt', 'Cost Efficiency', 'Innovation'],
                    datasets: [{
                        label: 'Our Performance',
                        data: [85, 92, 95, 88, 90, 82],
                        borderColor: '#2762cb',
                        backgroundColor: 'rgba(39, 98, 203, 0.2)'
                    },
                    {
                        label: 'Industry Average',
                        data: [75, 80, 85, 78, 82, 70],
                        borderColor: '#dc3545',
                        backgroundColor: 'rgba(220, 53, 69, 0.2)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }
    }

    // Custom Report Charts
    function initializeCustomCharts() {
        const ctx1 = document.getElementById('customReportChart');
        if (ctx1) {
            new Chart(ctx1.getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['Q1', 'Q2', 'Q3', 'Q4'],
                    datasets: [{
                        label: 'Contract Value',
                        data: [1250000, 1450000, 1680000, 1920000],
                        borderColor: '#2762cb',
                        yAxisID: 'y'
                    },
                    {
                        label: 'Contract Count',
                        data: [45, 52, 58, 65],
                        borderColor: '#28a745',
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left'
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            grid: {
                                drawOnChartArea: false
                            }
                        }
                    }
                }
            });
        }
    }

    // Refresh Custom Report
    function refreshCustomReport() {
        // Destroy existing chart and reinitialize
        const chartElement = document.getElementById('customReportChart');
        if (chartElement) {
            const chart = Chart.getChart(chartElement);
            if (chart) {
                chart.destroy();
            }
            initializeCustomCharts();
        }
    }

    // Export functionality
    function openExportModal() {
        alert('Export functionality would open modal here');
    }

    function refreshAllReports() {
        location.reload();
    }

    // Initialize on load
    document.addEventListener('DOMContentLoaded', function() {
        initializeLifecycleCharts();
    });
</script>
{% endblock %}